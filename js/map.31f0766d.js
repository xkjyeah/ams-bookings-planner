(function(t){function e(e){for(var a,r,s=e[0],l=e[1],c=e[2],p=0,h=[];p<s.length;p++)r=s[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&h.push(o[r][0]),o[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},o={map:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/ams-bookings-planner/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;i.push([1,"chunk-vendors"]),n()})({"00e9":function(t,e,n){},1:function(t,e,n){t.exports=n("2318")},2318:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app"},[n("div",{staticClass:"search-results"},[t.unknownAuth?n("div",{staticClass:"not-logged-in"},[n("div",[t._v("Loading...")])]):t.notLoggedIn?n("div",{staticClass:"not-logged-in"},[n("button",{on:{click:t.login}},[t._v("Log in")])]):n("div",{staticClass:"search-list",class:{"viewing-map":t.viewingMap},on:{click:function(e){t.viewingMap=!1}}},[n("table",{staticClass:"the-table"},[n("tbody",t._l(t.vehicles,(function(e,a){return n("tr",{key:e.registrationNumber,class:{"vehicle-stopped":"Stopped"===e.vehicleStatus,"vehicle-idling":"Idling"===e.vehicleStatus,"vehicle-inactive":"Inactive"===e.vehicleStatus}},[n("td",{staticStyle:{width:"6.5em"}},[t._v(" "+t._s(e.registrationNumber)),n("br"),n("span",{staticClass:"vehicle-status"},[t._v("("+t._s(e.vehicleStatus)+")")])]),n("td",{staticClass:"location"},[n("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.showOnMap(e)}}},[t._v(" "+t._s(e.location)+" ")]),n("br"),t._v(" "+t._s(e.created&&t.sAgo(e.created))+" ")]),n("td",[t._v(" "+t._s(e.speed)+"km/h ")])])})),0)])]),n("gmap-map",{ref:"searchMap",staticClass:"search-map",attrs:{center:t.mapCenter,zoom:t.mapZoom,options:t.mapOptions},on:{drag:function(e){t.selected=null},zoom_changed:function(e){t.mapZoom=e}}},t._l(t.vehicles,(function(e,a){return n("gmap-marker",{key:e.registrationNumber,attrs:{position:{lat:e.lat,lng:e.lng},icon:t.image(e)}})})),1)],1)])},i=[],r=(n("99af"),n("7db0"),n("d81d"),n("d3b7"),n("acd8"),n("e25e"),n("ac1f"),n("466d"),n("498a"),n("ddb0"),n("2ef0")),s=n.n(r),l=(n("b383"),n("59ca")),c=n.n(l),u=(n("66ce"),n("ea7b"),n("301f")),p=n.n(u),h={apiKey:"AIzaSyD13f_m0clyvTunsWRoyvhmBF1r5Lrqt4w",authDomain:"ams-bookings-planner.firebaseapp.com",databaseURL:"https://ams-bookings-planner.firebaseio.com",projectId:"ams-bookings-planner",storageBucket:"ams-bookings-planner.appspot.com",messagingSenderId:"553699052004"};c.a.initializeApp(h);var g=c.a.auth(),d=c.a.database(),f={name:"app",data:function(){return{authState:null,searchQuery:"",selected:null,searchResults:[],mapCenter:{lat:1.38,lng:103.8},mapZoom:14,inFlight:!1,viewingMap:!1,mapOptions:{mapTypeControl:!1},vehicles:[]}},computed:{sAgo:function(){return function(t){return p()(new Date(t))}},selectedVehicle:function(){var t=this;return this.vehicles.find((function(e){return e.registrationNumber===t.selected}))},image:function(){return function(t){return google&&google.maps&&google.maps.Point?{url:v(t.registrationNumber,"Moving"===t.vehicleStatus?"#090":"Stopped"===t.vehicleStatus?"#ccc":"Inactive"===t.vehicleStatus?"#ccc":"Idling"===t.vehicleStatus?"#f00":"#00f",t.direction,"Stopped"===t.vehicleStatus||"Inactive"===t.vehicleStatus?"0.5":"1.0"),anchor:new google.maps.Point(40,50),size:new google.maps.Size(80,80),scaledSize:new google.maps.Size(80,80)}:null}},unknownAuth:function(){return null===this.authState},notLoggedIn:function(){return!1===this.authState},gmapsHref:function(){return"https://www.google.com/maps/search/?api=1&query=".concat(this.mapCenter.lat,",").concat(this.mapCenter.lng)},validQuery:function(){return 6===this.searchQuery.length||!/^[0-9]+$/.test(this.searchQuery)}},created:function(){var t=this;g.onAuthStateChanged((function(e){t.testAuth()}))},mounted:function(){var t=this;d.ref("/vehicles").on("value",(function(e){e&&t.handleIncomingSnapshot(e)}))},watch:{selectedVehicle:function(t){t&&this.$refs.searchMap.panTo({lat:t.lat,lng:t.lng})}},methods:{handleIncomingSnapshot:function(t){if(t){var e=/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/,n=function(t){var n=t.match(e);return n?new Date(parseInt(n[1]),parseInt(n[2])-1,parseInt(n[3]),parseInt(n[4]),parseInt(n[5]),parseInt(n[6])).getTime():null},a=t.val(),o=s.a.values(a).map((function(t){return{created:n(t.created)||0,direction:parseInt(t.direction),registrationNumber:t.registrationNumber,speed:parseInt(t.speed),lat:parseFloat(t.lat),lng:parseFloat(t.lng),location:t.location,vehicleStatus:t.vehicleStatus}}));this.vehicles=o}},testAuth:function(){var t=this;d.ref("/vehicles").once("value").then((function(e){t.authState=!0,t.handleIncomingSnapshot(e)}),(function(){t.authState=!1}))},login:function(){var t=new c.a.auth.GoogleAuthProvider;t.addScope("email"),g.signInWithPopup(t)},showOnMap:function(t){this.mapCenter={lat:parseFloat(t.lat),lng:parseFloat(t.lng)},this.mapZoom=17,this.viewingMap=!0,this.selected=t.registrationNumber}}};function v(t,e,n,a){var o='\n  <?xml version="1.0" ?>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    version="1.1"\n    xmlns:xlink="http://www.w3.org/1999/xlink"\n    width="80" height="80">\n\n    <g transform="translate(40, 50)\n                  rotate('.concat(-45*(n-1),')\n                  scale(1.5)\n                  translate(-40, -50)"\n      opacity="').concat(a,'">\n      \x3c!-- body --\x3e\n      <polygon points="35,37 45,37 45,60 35,60" fill="#EEEEEE" stroke="#666666" />\n      \x3c!-- windshield --\x3e\n      <polygon points="35,40 45,40 45,43 35,43" fill="#0000FF" stroke="#666666" />\n      \x3c!-- wing mirror --\x3e\n      <polygon points="33,41 35,41 35,42 33,42" fill="#EEEEEE" stroke="#666666" />\n      <polygon points="47,41 45,41 45,42 47,42" fill="#EEEEEE" stroke="#666666" />\n      \x3c!-- front lights --\x3e\n      <line x1="36" y1="37" x2="38" y2="37" stroke="#FF9900" stroke-width="2"/>\n      <line x1="44" y1="37" x2="42" y2="37" stroke="#FF9900" stroke-width="2"/>\n      \x3c!-- rear lights --\x3e\n      <line x1="36" y1="60" x2="38" y2="60" stroke="#FF0000" stroke-width="2"/>\n      <line x1="44" y1="60" x2="42" y2="60" stroke="#FF0000" stroke-width="2"/>\n\n    </g>\n\n    <polygon points="30,20 40,50 50,20" fill="').concat(e,'" />\n\n    <rect x="1" width="78" y="20" height="12" fill="#FFFFFF" stroke="#000000" stroke-width="1" />\n    <text text-anchor="middle" x="40" y="29"\n      color="#000000" style="font-size: 11px; font-family: sans-serif">').concat(t,"</text>\n  </svg>\n  ").trim();return"data:image/svg+xml;charset=UTF-8;base64,"+btoa(o)}var m=f,b=(n("cb09"),n("2877")),y=Object(b["a"])(m,o,i,!1,null,null,null),w=y.exports;a["default"].use(n("755e"),{load:{key:"AIzaSyBvWE_sIwKbWkiuJQOf8gSk9qzpO96fhfY"}}),new a["default"]({el:"#app",render:function(t){return t(w)}})},cb09:function(t,e,n){"use strict";var a=n("00e9"),o=n.n(a);o.a}});
//# sourceMappingURL=map.31f0766d.js.map